#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{aecompl}
\usepackage{babel}
\usepackage{setspace}

\usepackage{amsmath}
\usepackage{amssymb}

\doublespacing
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding default
\font_roman "ae" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 0
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2.5cm
\bottommargin 2.5cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes true
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\author -2100369821 "cpicoche"
\author -666822487 "frederic"
\end_header

\begin_body

\begin_layout Title
Identifying dynamic coupling between interacting populations using Granger
 causality and convergent cross-mapping: a reconciliation
\begin_inset Note Note
status open

\begin_layout Plain Layout
let's see if this flies
\end_layout

\end_inset


\end_layout

\begin_layout Author
F.
 Barraquand, C.
 Picoche, M.
 Detto & F.
 Hartig
\end_layout

\begin_layout Abstract
Finding who interacts with whom based on time series data is a key endeavour
 of statistical ecology.
 Here, we show that multivariate autoregressive (MAR) modelling of finite
 but arbitrary order can be used, with appropriate log transformation and
 model selection based on information criteria, in order to infer causal
 links between interacting populations.
 Causality is here understood in the sense of Granger, i.e.
 time series 
\begin_inset Formula $x$
\end_inset

 Granger causes 
\begin_inset Formula $y$
\end_inset

 if information on present and past values of 
\begin_inset Formula $x$
\end_inset

 helps predicting future values of 
\begin_inset Formula $y$
\end_inset

.
 Recent nonlinear approaches such as convergent cross-mapping (CCM) have
 been put forward to alleviate potential issues of Granger causality (GC),
 notably due to the assumption of linearity in most implementations of GC.
 This has led to a relative skepticism about the ability of (log)-linear
 parametric methods to infer causal links in nonlinear dynamical systems.
 The merits of nonlinear and nonparametric models notwithstanding, the present
 results show that the demise of parametric and linear modelling has been
 somewhat exaggerated.
 Not only parametric MAR(p) models are able to infer causal links for a
 number of nonlinear (stochastic) systems, but they can even do so for datasets
 with highly nonlinear dynamical behaviour (e.g., limit cycles in real data,
 simulated chaotic dyamics).
 GC demonstrates, surprisingly, similar performances to CCM in a number
 of highly nonlinear cases.
 We further show that the (log)-linear framework can be extended to large
 interaction networks, provided some assumptions about the interaction structure.
 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
MAR(p) models have additional benefits, such as enabling comparison to theoretic
al models which helps to stimulate theoretical developement.
\end_layout

\end_inset

Finally, we discuss nonparametric, spectral and nonlinear extensions of
 Granger causality approaches that could be of use to ecologists.
\begin_inset Note Note
status open

\begin_layout Plain Layout
257 words.
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
Keywords:
\series default
 time series, interaction network, interaction strength, causal inference,
 feedback, food web, community dynamics.
\end_layout

\begin_layout Section*
Introduction
\end_layout

\begin_layout Standard
There is a diversity of viewpoints regarding the importance of interactions
 between species for predicting their joint population dynamics; a division
 that can be traced back at least to the Clementsian (integrated) vs Gleasionan
 (stochastically dominated) views of plant communities 
\begin_inset CommandInset citation
LatexCommand citep
key "chase2003community"
literal "true"

\end_inset

.
 Should one predict a species dynamics together with other species in the
 same community or separately? Measuring linkages between different species'
 population dynamics is a key statistical endeavour that has ramifications
 for fields as varied as coexistence theory (where the ratio intra/inter
 measures niche differentiation, 
\begin_inset CommandInset citation
LatexCommand citet
key "adler_coexistence_2010,adler_competition_2018"
literal "false"

\end_inset

 + others) or ecosystem-based fisheries management 
\begin_inset CommandInset citation
LatexCommand citep
key "link2002does,pikitch2004ecosystem"
literal "true"

\end_inset

.
 There is, however, a continued tension within ecology and related fields
 regarding the importance of species interactions for community dynamics.
 This could arises not only from disagreements between experimental and
 field studies (REFs plant lit, 
\begin_inset CommandInset citation
LatexCommand citealp
key "tuck_strong_2018"
literal "false"

\end_inset

) but also from different definitions of what the term interaction even
 means 
\begin_inset CommandInset citation
LatexCommand citep
key "berlow2004interaction,wootton2005mis"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
In many branches of statistical and theoretical ecology that have access
 to temporal records of population sizes, an interaction between species
 can be defined at the population level: two species 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 are deemed to interact if species 
\begin_inset Formula $i$
\end_inset

's population growth rate is affected by the temporal variation in the populatio
n density of species 
\begin_inset Formula $j$
\end_inset

 or vice-versa 
\begin_inset CommandInset citation
LatexCommand citep
key "berlow2004interaction"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
This definition maps well both to theoretical ecology, where communities
 are modelled as variations of the generalized Lotka-Volterra equations
 (e.g., 
\begin_inset CommandInset citation
LatexCommand citealp
key "may1973stability,yodzis1998local,coyte2015ecology"
literal "true"

\end_inset

; eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GLV"

\end_inset

)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{dN_{i}}{dt}=r_{i}N_{i}+\sum_{j=1}^{S}{g_{ij}(N_{i},N_{j})N_{j}}\label{eq:GLV}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
and statistical time series models 
\begin_inset CommandInset citation
LatexCommand citep
key "ives2003ecs,mutshinda2009drives,mutshinda2011multispecies,hampton2013quantifying"
literal "true"

\end_inset

, that make similar assumptions for stochastic models in discrete time.
 In other words, an interaction between species can be defined as a causal
 influence from species 
\begin_inset Formula $j$
\end_inset

 to species 
\begin_inset Formula $i$
\end_inset

 in a stochastic dynamical system describing the community dynamics, which
 has also been referred to as local dependence 
\begin_inset CommandInset citation
LatexCommand citep
key "schweder1970composable"
literal "false"

\end_inset

, dynamic causation 
\begin_inset CommandInset citation
LatexCommand citep
key "aalen1987dynamic,aalen2012causality,sugihara2012detecting"
literal "false"

\end_inset

, and Granger-Wiener causality 
\begin_inset CommandInset citation
LatexCommand citep
key "Granger1969,geweke1982measurement"
literal "false"

\end_inset

 in the more statistical literature.
\end_layout

\begin_layout Standard
To quantify dynamic causation between species using time series data, ecologists
 have used so far a number of statistical models ranging from mechanistic
 to purely phenomenological.
 They include most notably multivariate autoregressive models or order one,
 or MAR(1) models (also called VAR(1) - vector autoregressive models).
 These are statistical multispecies generalizations of the Gompertz discrete-tim
e single-species models 
\begin_inset CommandInset citation
LatexCommand citep
key "ives2003ecs,mutshinda2009drives"
literal "true"

\end_inset

.
 MAR(1) can to a large extent infer linkages between species population
 dynamics 
\begin_inset CommandInset citation
LatexCommand citep
key "hampton2013quantifying,certain2018how"
literal "false"

\end_inset

.
 MAR(p) models, with a maximum time lag of order 
\begin_inset Formula $p\geq1$
\end_inset

, generalize the MAR(1) framework familiar to ecologists and are interestingly
 linked to one of the most celebrated causality concept, the so-called Granger-W
iener causality 
\begin_inset CommandInset citation
LatexCommand citep
key "Granger1969,sims1980,Ding2006,Chen2006,barnett2009granger,detto2012causality,sugihara2012detecting,barnett_mvgc_2014"
literal "true"

\end_inset

.
 Granger-Wiener causality (usually referred to as Granger causality or GC
 for short) is a causality concept that is strongly tied to the idea that
 the cause must precede in time the effect.
 This corresponds to the intuition of many biologists 
\begin_inset CommandInset citation
LatexCommand citep
key "mayr1961cause"
literal "false"

\end_inset

 and especially ecologists, familiar with predators lagging 1/4 of cycle
 behind their prey population dynamics 
\begin_inset CommandInset citation
LatexCommand citep
key "may1973stability"
literal "false"

\end_inset

.
 There are other ways to define causality, through interventions notably
 
\begin_inset CommandInset citation
LatexCommand citep
before "e.g."
key "pearl2009causal"
literal "true"

\end_inset

, which are very useful in experimental setting, but usually less practical
 in a dynamical setting 
\begin_inset CommandInset citation
LatexCommand citep
key "aalen2012causality"
literal "false"

\end_inset

.
 If a dynamical model for time series 
\begin_inset Formula $y$
\end_inset

 can see its in-sample predictive ability improve by inclusion of time series
 
\begin_inset Formula $x$
\end_inset

, we say that 
\begin_inset Formula $x$
\end_inset

 Granger-causes 
\begin_inset Formula $y$
\end_inset

.
 This definition is rather general and does not specify, in general, any
 sort of model framework.
 It can in principle be applied to phenomenological and mechanistic frameworks
 alike, as well as in nonparametric settings 
\begin_inset CommandInset citation
LatexCommand citep
key "detto2012causality"
literal "true"

\end_inset

.
 However, GC testing is often used in contexts were the a priori information
 on community dynamics is limited, so that one needs to reduce the universe
 of possible model formulations to a handful of contrasted scenarios.
 In this context, GC is usually tested within the context of statistically
 friendly MAR(p) models for whom confidence intervals for coefficients,
 model selection, and other inferential tools are well understood.
 In an ecological setting, we use mainly log-linear models because the MAR
 framework applies to log-abundances 
\begin_inset CommandInset citation
LatexCommand citep
key "ives2003ecs"
literal "true"

\end_inset

.
 Ecologists have therefore been using Granger causality many times 
\begin_inset CommandInset citation
LatexCommand citep
before "reviewed in"
key "hampton2013quantifying"
literal "false"

\end_inset

 without perhaps knowing it.
\end_layout

\begin_layout Standard
In the last decade, other methods such as Convergent Cross-Mapping (CCM;
 
\begin_inset CommandInset citation
LatexCommand citealp
key "sugihara2012detecting"
literal "true"

\end_inset

) have been put forward as a new way to infer interactions between species,
 and alleviate problems due to the limitation of linear autoregressive models
 (although, it should be noted that MAR(p) models are log-linear, which
 makes them essentially power-law models, hence able to model some nonlinearitie
s).
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

 made a somewhat strong criticism of the Granger causality concept, which
 they deemed best suited for linear systems dominated by stochasticity,
 and therefore unfit to model strongly nonlinear dynamical systems with
 a strong deterministic skeleton.
 However, subsequent work has shown that even the simplest MAR(1) models
 can be surprisingly robust to nonlinearities 
\begin_inset CommandInset citation
LatexCommand citep
key "certain2018how"
literal "false"

\end_inset

, uncovering interactions in the case of nonlinear interactions with a fixed
 point and even limit cycles.
 Moreover, CCM performed relatively similarly to linear Granger causality
 for a large array of 2-species simulation models 
\begin_inset CommandInset citation
LatexCommand citep
key "krakovska2018comparison"
literal "false"

\end_inset

.
 Given the great conceptual and practical simplicity of MAR(p) models, there
 is therefore a need to better understand in which ecological scenarios
 linear GC can be a good approximation for interaction inference, and in
 which case more elaborate techniques, such as CCM, are warranted.
\end_layout

\begin_layout Standard
In this article, we first evaluate the performance of MAR(p) models and
 compare it to CCM on a number of ecological examples for which CCM is currently
 thought to be more appropriate.
 We demonstrate that harsh criticism of the Granger causality concept by
 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

 may have been induced by nonstandard model selection and evaluation techniques.
 Using simpler model selection techniques, routinely used by statisticians
 
\begin_inset CommandInset citation
LatexCommand citep
key "Lutkepohl2005"
literal "true"

\end_inset

, in order to the infer lag order 
\begin_inset Formula $p$
\end_inset

 of MAR(p) models as well as their parametric structure, we show that Granger
 causality techniques can in fact infer interactions suprisingly well in
 nonlinear cases.
 We then highlight intriguing parameter configurations and empirical case
 studies where Granger causality and Sugihara et al.'s convergent cross-mapping
 (CCM) either both fail or both work, which suggests that seemingly foreign
 causality concepts might in fact share some underlying mathematical similaritie
s [To edit as a function of what we find].
 Throughout, we take particular care to output both effect sizes and statistical
 significance of causal influences, and we discuss the meaning of uncertainties
 around causal effects, when p-values are not calibrated [To edit again
 as a function of what we eventually report].
 We finally demonstrate that Granger causality / MAR(p) modelling can be
 scaled up to large interaction networks using appropriate model regularization
 techniques (LASSO-based).
\end_layout

\begin_layout Section*
Methods and models
\end_layout

\begin_layout Standard
In the following, we recall the basics of Granger causality concepts and
 MAR(p) - Multivariate AutoRegressive - modelling, which is the most common
 way (not the only one) to assess Granger causality.
 For completeness, we also present some common nonlinear alternatives to
 MAR(p) modelling which stays within the Granger causality purview in Appendix
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Nonlinear-Granger-causality"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 We describe shortly thereafter convergent-cross mapping 
\begin_inset CommandInset citation
LatexCommand citep
key "sugihara2012detecting"
literal "false"

\end_inset

, which is implemented as well but takes a different approach to causal
 inference, based on dynamical systems theory and state-space reconstruction.
 We then describe the real datasets and numerical simulations that will
 be used for evaluating causal inference methods.
\end_layout

\begin_layout Subsection*
Causality concepts
\end_layout

\begin_layout Subsubsection*
Granger causality and MAR(p) implementation
\end_layout

\begin_layout Standard
\begin_inset Formula $\mathbf{x}=(x_{t})_{t\in[|1:T|]}$
\end_inset

Granger-causes 
\begin_inset Formula $\mathbf{y}=(y_{t})_{t\in[|1:T|]}\iff$
\end_inset

 including 
\begin_inset Formula $x$
\end_inset

 in a time series model for 
\begin_inset Formula $y$
\end_inset

 improves in-sample prediction of 
\begin_inset Formula $y$
\end_inset

.
 In the MAR(p) framework, this translates into performing two time series
 autoregressions to explain time series 
\begin_inset Formula $y$
\end_inset

, one with only 
\begin_inset Formula $y$
\end_inset

 and one with 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $x$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
y_{t}=\sum_{i=1}^{L}a_{i}y_{t-i}+\eta_{t}\label{eq:directGC}\\
y_{t}=\sum_{i=1}^{L}a_{1i}x_{t-i}+\sum_{i=1}^{L}a_{2i}y_{t-i}+\epsilon_{t}\label{eq:GC_bis}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Granger causality then occurs if 
\begin_inset Formula $\sigma_{\epsilon}^{2}<\sigma_{\eta}^{2}$
\end_inset

.
 When more than two variables are considered, simple GC has to be differentiated
 from conditional GC.
 Conditional GC occurs whenever a third variable 
\begin_inset Formula $z$
\end_inset

 is considered and corrected for.
\end_layout

\begin_layout Standard
When fitting a MAR(p) model, we typically estimate conditional GC.
 For instance, let us consider a MAR(1) model (eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MAR1"

\end_inset

) with 3 species, which may be familiar to ecologists through the works
 of 
\begin_inset CommandInset citation
LatexCommand citet
key "ives2003ecs,hampton2013quantifying"
literal "true"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{t}=\ln(\boldsymbol{N}_{t}),\,\,\,\mathbf{x}_{t+1}=\mathbf{a}+\mathbf{Bx}_{t}+\mathbf{Cu}_{t}+\mathbf{e}_{t},\mathbf{e}_{t}\sim\mathcal{N}_{3}(\boldsymbol{0},\bm{\Sigma})\label{eq:MAR1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
so that its 
\begin_inset Formula $\mathbf{B}$
\end_inset

 (interaction) matrix is defined by
\end_layout

\begin_layout Standard
\align center
\begin_inset Formula 
\begin{equation}
\mathbf{B}=\begin{pmatrix}b_{11} & b_{12} & b_{13}\\
b_{21} & b_{22} & b_{23}\\
b_{31} & b_{32} & b_{33}
\end{pmatrix}\label{eq:B_mAR3}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Here, whenever 
\begin_inset Formula $b_{12}$
\end_inset

 is significantly different from zero, we have a causal influence 
\begin_inset Formula $x_{2}\rightarrow x_{1}|(x_{3},\mathbf{u})$
\end_inset

, that is, an influence of 
\begin_inset Formula $x_{2}$
\end_inset

 on 
\begin_inset Formula $x_{1}$
\end_inset

 conditional to the population density 
\begin_inset Formula $x_{3}$
\end_inset

 of species 3 and all the control environmental variables in the vector
 
\begin_inset Formula $\mathbf{u}$
\end_inset

.Using centered data so that the intercept disappears, the MAR(p) model is
 defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{t+1}=\sum_{q=1}^{p}\mathbf{B}^{(q)}\mathbf{x}_{t}+\mathbf{e}_{t},\;\mathbf{e}_{t}\sim\mathcal{N}_{d}(\boldsymbol{0},\bm{\Sigma})\label{eq:MARp}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We drop
\change_inserted -666822487 1555582903
 
\change_unchanged

\begin_inset Formula $\mathbf{u_{t}}$
\end_inset

 which corresponds to a special case where a subset of the variables has
 a one-way causal impact.
 The condition for an interaction from species 
\begin_inset Formula $j$
\end_inset

 to species 
\begin_inset Formula $i$
\end_inset

 given all other species densities and variables then becomes, in a general
 MAR(p) setting (according to eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MARp"

\end_inset

, ): 
\begin_inset Formula 
\begin{equation}
\exists b_{ij}^{(q)}\neq0\Leftrightarrow x_{j}\rightarrow x_{i}|(x_{1},...,x_{j-1},x_{j+1},...,x_{d})\label{eq:conditionGC_MARp}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where each time lag is indexed by 
\begin_inset Formula $q$
\end_inset

.
 This highlights immediately the high model dimensionality that can be attained
 with high temporal lag order 
\begin_inset Formula $p$
\end_inset

 and high number of species.
 Conversely, direct or pairwise GCausality testing between 
\begin_inset Formula $x_{i}$
\end_inset

 and 
\begin_inset Formula $x_{j}$
\end_inset

 is assessed through a bivariate autoregressive model for each 
\begin_inset Formula $(i,j)$
\end_inset

 pair, and therefore uses a considerably lower-dimensional model.
 Direct GC testing requires, however, some false discovery correction to
 attain meaningful statistical significance 
\begin_inset CommandInset citation
LatexCommand citep
key "mukhopadhyay2006causality"
literal "false"

\end_inset

.
 In the following, we use a Benjamini-Hochberg correction 
\change_inserted -2100369821 1555778798

\begin_inset CommandInset citation
LatexCommand citep
key "benjaminihochberg1995"
literal "false"

\end_inset


\change_deleted -2100369821 1555778786
(REF)
\change_unchanged
.
\end_layout

\begin_layout Standard
MAR(p) model fitting has been performed using the package 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|vars|
\end_layout

\end_inset

 in
\series bold
 
\series default

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|R|
\end_layout

\end_inset

, which uses ordinary least squares for estimation.
 We used the BIC as a default for lag order selection, although we also
 considered other information criteria for lag order selection (see below).
 The presence of Granger causality was assessed by the statistical significance
 (and magnitude) of the interaction matrix coefficients, and more directly
 using parametric significance tests for nested models.
 For pairwise Granger causality testing, we used the function 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|grangertest|
\end_layout

\end_inset

 in the R package 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|lmtest|
\end_layout

\end_inset

 which performs a Wald test for nested models.
 For conditional Granger causality testing, we use the function 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|causality|
\end_layout

\end_inset

 in package 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|vars|
\end_layout

\end_inset

 which provides F-tests for the nested models.
 Both tests and implementations provided similar answers when compared.
\end_layout

\begin_layout Subsubsection*
Convergent-cross mapping
\end_layout

\begin_layout Standard
Convergent cross-mapping 
\begin_inset CommandInset citation
LatexCommand citep
key "sugihara2012detecting"
literal "false"

\end_inset

 relies on state-space reconstruction.
 We assume two time series 
\begin_inset Formula $\mathbf{x}=(x_{t})_{t\in[|1:T|]}$
\end_inset

 and 
\begin_inset Formula $\mathbf{y}=(y_{t})_{t\in[|1:T|]}$
\end_inset

 as previously.
 The attractor manifold 
\begin_inset Formula $M_{X}$
\end_inset

 is constructed as a set of 
\emph on
E
\emph default
-dimensional vectors 
\begin_inset Formula $\tilde{\mathbf{x}}(t)=(x(t),x(t-\tau),x(t-2\tau),...,x(t-(E-1)\tau),...)$
\end_inset

 for 
\begin_inset Formula $t=1+(E-1)\tau$
\end_inset

 to 
\begin_inset Formula $t=T$
\end_inset

.
 
\begin_inset Formula $E$
\end_inset

 is the embedding dimension, denoting how many time lags one counts back
 in time.
 This set of vectors constitutes the reconstructed manifold.
 We now find the E+1 nearest neighbours of
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $\tilde{\mathbf{x}}(t)$
\end_inset

 in 
\begin_inset Formula $M_{X}$
\end_inset

.
 Their time indices are denoted 
\begin_inset Formula $t_{1},...,t_{E+1}$
\end_inset

.
 The reconstruction of 
\begin_inset Formula $y_{t}$
\end_inset

from 
\begin_inset Formula $M_{X}$
\end_inset

 proceeds as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{y}(t)|M_{X}=\sum_{i=1}^{E+1}w_{i}y(t_{i})
\]

\end_inset


\end_layout

\begin_layout Standard
with 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $w_{i}=Â u_{i}/\sum_{i=1}^{E+1}u_{j}$
\end_inset

, and 
\begin_inset Formula $u_{j}=\exp\left(\frac{-d(\tilde{\mathbf{x}}(t),\tilde{\mathbf{x}}(t_{j}))}{d(\tilde{\mathbf{x}}(t),\tilde{\mathbf{x}}(t_{1}))}\right)$
\end_inset

 where 
\begin_inset Formula $d(\tilde{\mathbf{x}}(t),\tilde{\mathbf{x}}(t_{1}))$
\end_inset

 is the minimal distance.
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
The cross-map skill from X to Y is then measured by the correlation coefficient
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $\rho(\mathbf{y},\hat{\mathbf{y}}|M_{X})>0$
\end_inset

, which increases with the library size L if Y causes X.
 The surprising thing here being that prediction of 
\begin_inset Formula $Y$
\end_inset

 by 
\begin_inset Formula $M_{X}$
\end_inset

 is equivalent to 
\begin_inset Formula $Y$
\end_inset

 causing 
\begin_inset Formula $X$
\end_inset

 and not the other way around 
\begin_inset CommandInset citation
LatexCommand citep
key "sugihara2012detecting"
literal "false"

\end_inset

.
 Hence, to know if X causes Y, we look at 
\begin_inset Formula $\rho(\mathbf{x},\hat{\mathbf{x}}|M_{Y})$
\end_inset

.
\end_layout

\begin_layout Standard
Even though there are no standard ways of computing associated p-values
 for the convergent cross-mapping skill 
\begin_inset Formula $\rho$
\end_inset

, several formulations have been proposed:
\end_layout

\begin_layout Itemize
\begin_inset CommandInset citation
LatexCommand citet
key "cobey2016limits"
literal "false"

\end_inset

 suggested 
\begin_inset Formula $p(X\nrightarrow Y)=\frac{1}{n}\sum_{i=1}^{n}\text{\textbf{1}}_{i}\left((\rho(\mathbf{x},\hat{\mathbf{x}}|M_{Y,\text{Lmax}})<\rho(\mathbf{x},\hat{\mathbf{x}}|M_{Y,\text{Lmin}})\right)$
\end_inset

 where 
\begin_inset Formula $n$
\end_inset

 is the number of libraries of size 
\begin_inset Formula $L$
\end_inset

 that were used to build 
\begin_inset Formula $M_{Y}$
\end_inset

.
 
\begin_inset Formula $M_{Y,\text{Lmax}}$
\end_inset

 (respectively, 
\begin_inset Formula $M_{Y,\text{Lmin}}$
\end_inset

) is the manifold constructed with the maximum (respectively, minimum) library
 size.
 Two different versions of this p-value can be computed depending on whether
 one uses sampling with replacement (the bootstrap) for the librairies or
 sampling without replacement (in which case 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $M_{Y,\text{Lmin}}$
\end_inset

 varies but not 
\begin_inset Formula $M_{Y,\text{Lmax}}$
\end_inset

).
\change_inserted -666822487 1555584437

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -666822487 1555584517

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
We need to decide if we use and report both of those CB P-values? Perhaps,
 given that we already know that the one without replacement produce crap,
 we use the one with replacement? Or have we already made all the simulations
 with the other one?
\change_inserted -2100369821 1555778844
 I think we still need to talk about CB, but only refer to the Appendix
 to justify the fact that we won't use it after
\change_inserted -666822487 1555918413
 -> F: OK for me
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Itemize
for periodic signals, or, more generally, a shared forcing driver, spurious
 causality can be found between time series.
 We compute surrogate time series which keep the periodicity of the signal
 but modify its residuals so that the cross-correlations containing causal
 information are 
\begin_inset Quotes eld
\end_inset

erased
\begin_inset Quotes erd
\end_inset

.
 Cross-mapping is then computed on the surrogates and compared to the real
 value.
 In this case, 
\begin_inset Formula $p(X\nrightarrow Y)=\frac{1}{n}\sum_{i=n}^{n}\text{\textbf{1}}_{i}\left((\rho(\mathbf{x}_{\text{real}},\mathbf{\hat{x}}_{\text{real}}|M_{Y})<\rho(\mathbf{x}_{\text{surr}},\mathbf{\hat{x}}_{\text{surr}}|M_{Y})\right)$
\end_inset


\end_layout

\begin_layout Itemize
for large simulations (10 and 20 species) without a confounding abiotic
 driver, we also computed a surrogate-based p-value, but surrogates were
 only computed by a random permutation of the values within the time series.
\end_layout

\begin_layout Standard
The analyses have been performed in R [3.4.4] using the package rEDM [version
 0.7.1 
\begin_inset CommandInset citation
LatexCommand citealp
key "ye_hao_2018_1935847"
literal "false"

\end_inset

].
 For each time series, we retrieved the best embedding dimension (which
 maximizes the forecast skill of the simplex) and used it in the cross-mapping
 function, with 100 different libraries for each library size and library
 size depending on the length of the time series 
\begin_inset Note Note
status open

\begin_layout Plain Layout
[this is not enough: we need to discuss the size we choose and to be consistent
 in our scripts]
\end_layout

\end_inset

.
 The libraries were obtained with random draws without replacement from
 the original time series.
\end_layout

\begin_layout Subsubsection*
Granger causality in high-dimensional models
\end_layout

\begin_layout Standard
Full MAR(p) model fitting is highly impractical for high-dimensional models,
 unless very long time series are considered or special constraints are
 implemented to reduce the dimensionality 
\begin_inset CommandInset citation
LatexCommand citep
key "michailidis2013autoregressive"
literal "false"

\end_inset

.
 If there are 
\begin_inset Formula $d$
\end_inset

 species and 
\begin_inset Formula $p$
\end_inset

 timelags, a 
\begin_inset Formula $d\times d\times p$
\end_inset

 dimensional model needs to be fitted to the data.
 For instance, let us imagine that a system involving 10 species with at
 least one cycling species is considered (and its cyclicity is probably
 not induced by the species in the network).
 To model it properly, we need 
\begin_inset Formula $p=2$
\end_inset

 (long, regular cyclic behaviour in a one species AR(p) model requires 
\begin_inset Formula $p>1$
\end_inset

).
 We then have 200 parameters in the interaction 
\series bold
B
\series default

\begin_inset Formula $^{(q)}$
\end_inset


\series bold
 
\series default
matrices only.
 Even a MAR(1) model will have 100 elements, and therefore would be impossible
 to fit properly without a set of time series of length above 100.
 Preliminary simulations 
\begin_inset CommandInset citation
LatexCommand citep
key "certain2018how,barraquand2018coastal"
literal "false"

\end_inset

 suggest that a nonlinear, stochastic ecological system of dimension 10
 or 12 requires approximately times series of length 500 to 800 to be fitted
 properly without implementing additional constraints.
 To deal with high-dimensionality for time series of long yet reasonable
 length (100 to 300 timesteps), we have considered two solutions:
\end_layout

\begin_layout Itemize
Pairwise Granger causality testing with False Discovery Rate (FDR) correction
 (Benjamini-Hochberg), with a philosophy similar to 
\begin_inset CommandInset citation
LatexCommand citet
key "mukhopadhyay2006causality"
literal "false"

\end_inset

.
 This done by fitting bivariate MAR(p) models, test for Granger causality
 in both directions, and then re-adjust the p-values obtained through the
 Benjamini-Hochberg correction.
\end_layout

\begin_layout Itemize
LASSO-penalized MAR(1) models with structured penalties, using the R package
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
verb|SIMoNe|
\end_layout

\end_inset


\series bold
 
\series default

\begin_inset CommandInset citation
LatexCommand citep
key "chiquet2008simone,charbonnier2010weighted"
literal "false"

\end_inset

.
 This allows to estimate (through non-zero interaction coefficients) conditional
 Granger causality.
 A naive approach to MAR(1) estimation would simply use the LASSO (Least
 Absolute Shrinkage and Selection Operator, 
\begin_inset CommandInset citation
LatexCommand citealp
key "tibshirani2015statistical"
literal "false"

\end_inset

) to set some of the coefficients to zero.
 Unfortunately, this approach is known to yield substantial bias whenever
 there is an important structure (for instance, modular) in the network.
 We have therefore used a technique that explicitly accounts for network
 structure in addition to selecting coefficients with the LASSO 
\begin_inset CommandInset citation
LatexCommand citep
key "charbonnier2010weighted"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection*
Simulated and real datasets of interacting species population dynamics
\end_layout

\begin_layout Subsubsection*
Real data: Veilleux's predator-prey cycles
\end_layout

\begin_layout Standard
The two first datasets that we consider are taken from 
\begin_inset CommandInset citation
LatexCommand citet
key "veilleux1979analysis"
literal "true"

\end_inset

 and have been analysed by other authors with mechanistic models which demonstra
ted two-way coupling 
\begin_inset CommandInset citation
LatexCommand citep
key "jost2000testing"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/time_series_small_dim_log.pdf
	width 95text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Time series of small-community models.
 Veilleux's predator-prey data are shown in (a) (dataset CC05) and (b) (dataset
 CC0375); an example simulation for the 2-species chaotic model is shown
 in panel (c) and a simulation of the competition model including an environment
al driver is illustrated in panel (d).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Deterministic chaos in two-species competition models
\end_layout

\begin_layout Standard
Here we use the same model as in 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

, a two-species discrete-time logistic competition model
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
x_{t+1} & =x_{t}(3.8-3.8x_{t}-0.02y_{t})\label{eq:two_species_chaotic_compet}\\
y_{t+1} & =y_{t}(3.5-3.5y_{t}-0.1x_{t})
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The models are, as in 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

, in the chaotic regime, which constitutes a strong test of the log-linear
 MAR(p) framework.
 The only thing that is varied is the initial condition, which is taken
 at random 500 times.
 Although we acknowledge that 
\begin_inset Quotes eld
\end_inset

mirage correlations
\begin_inset Quotes erd
\end_inset

 can occur in some datasets, we aimed at reproducting a realistic sample
 of what this model can provide, as there are no justifications to favor
 one specific set of initial conditions (outside of illustration purposes).
 The sample size is taken to be 
\begin_inset Formula $t_{m}=300$
\end_inset

 as in 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
Because a method that finds no interactions whenever absent is as important
 as one that finds interactions whenever they are present, we also consider
 the following deterministic 
\begin_inset Quotes eld
\end_inset

null competition
\begin_inset Quotes erd
\end_inset

 model:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
x_{t+1} & =x_{t}(3.8-3.8x_{t}-0\times y_{t})\label{eq:two_species_chaotic_compet-1}\\
y_{t+1} & =y_{t}(3.5-3.5y_{t}-0\times x_{t})
\end{align}

\end_inset


\end_layout

\begin_layout Standard
We will evaluate both GC and CCM's ability to find no interactions between
 these time series.
\end_layout

\begin_layout Subsubsection*
Two-species stochastic and nonlinear dynamics, including environmental drivers
\end_layout

\begin_layout Standard
First we consider a stochastic two-competition model, with Lokta-Volterra
 interactions in discrete time and a Ricker type of multispecies density-depende
nce.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
N_{1,t+1} & =N_{1,t}\exp(3-4N_{t,1}-2N_{t,2}+\epsilon_{1,t})\label{eq:twoSpeRickerStoch_compet}\\
N_{2,t+1} & =N_{2,t}\exp(2.1-0.31N_{t,1}-3.1N_{t,2}+\epsilon_{2,t})
\end{align}

\end_inset


\end_layout

\begin_layout Standard
This case was already investigated in 
\begin_inset CommandInset citation
LatexCommand citet
key "certain2018how"
literal "true"

\end_inset

, but including an environmental driver on species 1.
 Then we consider a variant of this model adding an environmental driver
 
\begin_inset Formula $u_{t}$
\end_inset

 that has the same effect on both species, which constitutes a challenge
 for any causal method (
\begin_inset Formula $u_{t}$
\end_inset

 is a confounding variable)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
N_{1,t+1} & =N_{1,t}\exp(3+0.5u_{t}-4N_{t,1}-2N_{t,2}+\epsilon_{1,t})\label{eq:StochTwoSpecies_withSynchroDriver}\\
N_{2,t+1} & =N_{2,t}\exp(2.1+0.5u_{t}-0.31N_{t,1}-3.1N_{t,2}+\epsilon_{2,t})
\end{align}

\end_inset


\end_layout

\begin_layout Standard
We consider, as in the deterministic case, the counterparts of the above
 models where the interspecific interactions are set to zero, i.e.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
N_{1,t+1} & =N_{1,t}\exp(3+0.5u_{t}-4N_{t,1}-0\times N_{t,2}+\epsilon_{1,t})\label{eq:twoSpeciesStoch_wDriver_noInteractions}\\
N_{2,t+1} & =N_{2,t}\exp(2.1+0.5u_{t}-0\times N_{t,1}-3.1N_{t,2}+\epsilon_{2,t})
\end{align}

\end_inset


\end_layout

\begin_layout Standard
We run 500 simulations for each model.
\end_layout

\begin_layout Subsubsection*
Ten- and twenty-species interaction webs
\end_layout

\begin_layout Standard
We consider a 10 species model which generalises the two-species Ricker
 competition to more species and more interaction types, with added stochasticit
y, and therefore represents a considerable challenge to interaction inference,
 due to the large quantity of potential false positives (many zero interactions)
 combined to both nonlinear dynamics and stochasticity.
 The dynamical equation can be written as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{n}_{t+1}=\mathbf{n}_{t}\circ\exp(\mathbf{r}+\mathbf{A}\mathbf{n}_{t}+\mathbf{e}_{t}),\mathbf{e}_{t}\sim\mathcal{N}(0,\sigma^{2}\mathbf{I})
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the abundance, the error 
\begin_inset Formula $\sigma^{2}=0.1$
\end_inset

 and the interaction matrix is defined to be 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
[[CP: Is it normal that it is sometimes 0.636 and sometimes 0.63? Just a detail.
 
\series bold
F: Let's check the code and edit accordingly
\series default
]] Done.
\end_layout

\end_inset


\begin_inset Formula 
\begin{equation}
\ensuremath{A=\begin{pmatrix}-4 & -2 & -0.4 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
-0.31 & -3.1 & -0.93 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0.636 & 0.636 & -2.12 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
-0.111 & -0.111 & 0.131 & -3.8 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0.5 & -2 & -2 & -0.4 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & -0.31 & -3.1 & -0.93 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0.636 & 0.636 & -2.12 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & -4 & -2 & -0.4\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & -0.31 & -3.1 & -0.93\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0.636 & 0.636 & -2.12
\end{pmatrix}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We use the same interaction matrix with Gompertz ( MAR(1) ) dynamics, and
 run 25 simulations over 500 time steps with different initial conditions.
\end_layout

\begin_layout Standard
We slightly modified this model to scale it up to 20 species.
 Its structure is still fairly modular (eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mat_20species"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset Note Note
status open

\begin_layout Plain Layout
Maybe put B in Appendix ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left

\size tiny
\begin_inset Formula 
\begin{equation}
B=\left(\begin{array}{cccccccccccccccccccc}
b_{1,1} & b_{1,2} & b_{1,3} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
b_{2,1} & b_{2,2} & b_{2,3} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
b_{3,1} & b_{3,2} & b_{3,3} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
b_{4,1} & b_{4,2} & b_{4,3} & b_{4,4} & b_{4,5} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & b_{5,4} & b_{5,5} & b_{5,6} & b_{5,7} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & b_{6,5} & b_{6,6} & b_{6,7} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & b_{7,5} & b_{7,6} & b_{7,7} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{8,8} & b_{8,9} & b_{8,10} & b_{8,11} & b_{8,12} & b_{8,13} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{9,8} & b_{9,9} & b_{9,10} & b_{9,11} & b_{9,12} & b_{9,13} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{10,8} & b_{10,9} & b_{10,10} & b_{10,11} & b_{10,12} & b_{10,13} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{11,8} & b_{11,9} & b_{11,10} & b_{11,11} & b_{11,12} & b_{11,13} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{12,8} & b_{12,9} & b_{12,10} & b_{12,11} & b_{12,12} & b_{12,13} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{13,8} & b_{13,9} & b_{13,10} & b_{13,11} & b_{13,12} & b_{13,13} & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{14,11} & b_{14,12} & b_{14,13} & b_{14,14} & b_{14,15} & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{15,14} & b_{15,15} & b_{15,16} & b_{15,17} & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{16,15} & b_{16,16} & b_{16,17} & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{17,15} & b_{17,16} & b_{17,17} & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{18,18} & b_{18,19} & b_{18,20}\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{19,18} & b_{19,19} & b_{19,20}\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & b_{20,18} & b_{20,19} & b_{20,20}
\end{array}\right)\label{eq:mat_20species}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the 20-species model, we also compare Ricker and Gompertz dynamics for
 25 different simulations over 1000 time steps, but in this case, coefficients
 are drawn from a random distribution (eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:coef_20species"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:coef_20species_condition"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
b_{i,j}=b_{min}+(b_{max}-b_{min})\beta(2,2)\label{eq:coef_20species}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
(b_{min},b_{max})=\begin{cases}
(0.05,0.1) & \forall i\neq j,\text{ with probability 0.2 (positive interaction)}\\
(-0.2,-0.1) & \forall i\neq j,\text{ with probability 0.8 (negative interaction)}\\
(-0.8,-0.3) & \forall i=j
\end{cases}\label{eq:coef_20species_condition}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For all datasets, real and simulated alike, the data are log-transformed
 before analysis.
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Actually, you take the exp of the simulations for 20 species-CCM.
 Not sure why ? F: That's a good question.
 I suspect that I did try non-transformed, and then it did not work well,
 so I switch back.
 But I don't really remember, so you're welcome to try the log-scale to
 homogeneize our analyses (and also see if it may improve something).
 Still running.
 But i guess there won't be a high difference, as we can see in the Veilleux
 example
\end_layout

\end_inset


\end_layout

\begin_layout Section*
Results
\end_layout

\begin_layout Standard
In each section, we apply both GC/MAR(p) modelling and CCM, except for high-dime
nsional datasets.
\end_layout

\begin_layout Subsection*
Real data: Veilleux's predator-prey cycles
\end_layout

\begin_layout Standard
Model selection of MAR(p) model by all information criteria selected a lag
 
\begin_inset Formula $p=1$
\end_inset

 for the CC05 dataset and a lag of 2 for the CC0.375 dataset (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ResultsVeilleux_lagOrder"

\end_inset

).
 The p-values for the GC test (null hypothesis: 
\begin_inset Quotes eld
\end_inset

no GC
\begin_inset Quotes erd
\end_inset

) demonstrate convincingly that the 
\begin_inset Quotes eld
\end_inset

no GC
\begin_inset Quotes erd
\end_inset

 hypothesis can be rejected, for both datasets (
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:P-valuesVeilleux"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/Lag_choice_veilleux.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of model information criteria vs.
 lag order for the predator-prey data, for the two datasets.
\begin_inset CommandInset label
LatexCommand label
name "fig:ResultsVeilleux_lagOrder"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering 
\backslash
begin{tabular}{c|c|c}    
\backslash
hline    Dataset & CC = 05 & CC = 0.375
\backslash

\backslash
    
\backslash
hline    Lag $p$ in VAR(p) & 1 & 2 
\backslash

\backslash
    
\backslash
hline    1 $
\backslash
rightarrow$ 2 & $2.79 
\backslash
times 10^{-11}$ & 0.0409
\backslash

\backslash
    2 $
\backslash
rightarrow$ 1 & $1.76 
\backslash
times 10^{-14}$ & 0.0464
\backslash

\backslash
   
\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
P-values for 
\change_deleted -666822487 1555918671
H_0
\change_inserted -666822487 1555918671

\begin_inset Formula $H_{0}$
\end_inset


\change_unchanged
: No Granger causality between 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "tab:P-valuesVeilleux"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
CCM also demonstrate bi-directional causality, as demonstrated by the increase
 in 
\begin_inset Formula $\rho(X,\hat{X}|M_{Y})$
\end_inset

 with library size 
\begin_inset Formula $L$
\end_inset

 in both directions (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:CCMVeilleux"

\end_inset

).
 
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/Veilleux_simulation_CCM.pdf
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergent cross-mapping for Veilleux's CC05 dataset (a and b) and CC0.375
 dataset (c and d).
 Dotted lines represent the confidence bands, obtained by bootstrapping.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:CCMVeilleux"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Deterministic chaos in two-species competition models
\end_layout

\begin_layout Standard
In the 2-species chaotic competition model high-order lags tend to be selected
 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ResultsDeterCompet_lagOrder"

\end_inset

) despite the single timelag considered in the simulation model (i.e., higher
 nonlinearity is identified as high-order lags).
 Despite this potential overparameterization, the GC tests show that causality
 is detected for most timelags (including the optimal one, p=7) whenever
 causality is present.
 Further, the tests are not able to reject the null hypothesis of no GC
 when GC is not present (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:GC_deterministic"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 GC performs therefore surprisingly well in this chaotic context.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/GC_per_lag.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Proportion of detected Granger-causality, at the 10% significance threshold,
 over 500 chaotic simulations with (left) and without (right) actual interaction
s between species, depending on the number of time lags taken into account
 (x-axis).
 Without interactions, the optimal lag is 3 and the Wald test cannot be
 performed for p>3.
\begin_inset CommandInset label
LatexCommand label
name "fig:GC_deterministic"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="9">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Granger
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
causality
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CCM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
log
\change_inserted -666822487 1555918692
-ratio
\change_unchanged
>0.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rho>0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rho>0.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both0.2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
With
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 -> 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 -> 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
69.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
50.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
56.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
54.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
54.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29.4%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Without
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 -> 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.4%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 -> 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
30.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
28.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.8%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Proportion of simulations with Granger-causality or CCM between x and y
 over 500 simulations, for the chaotic 2-species competition model.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
[FB and CP: We're still a bit unclear about the use of the 
\begin_inset Formula $\phi$
\end_inset

 coefficient for quantifying the agreement between the methods (from two
 binary time series).
 Intuitively, 
\begin_inset Formula $\phi$
\end_inset

 should be high for both high and low percentages for both methods, because
 they both produces in this case a lot of ones or a lot of zeroes.
 These results may suggest that ones and zeroes do not have completely symmetric
al effects? TODO: Introduce handmade function for computing 
\begin_inset Formula $\phi$
\end_inset

 CP: Still not ok.
 What do you do when you haves 0s in the denominator?] [Do we still want
 
\begin_inset Formula $\phi$
\end_inset

, if we cannot calibrate the p-values?
\change_inserted -666822487 1555918751
 F: good question, I still have to think about that, but I think we do.
 
\change_unchanged
]
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/chaos_comparison_CCM.pdf
	width 95text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergent-cross mapping on simulated deterministic data, with (left) and
 without (right) competition between the two species 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
[move to Appendix?] This is an idea: we can keep it for now here, for illustrati
on for Florian, and then move it to the Appendix later on.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Two-species stochastic and nonlinear dynamics
\end_layout

\begin_layout Subsubsection*
Without environmental driver
\end_layout

\begin_layout Standard
In our case with 2-species nonlinear competition and noise, we see that
 GC and CCM perform quite similarly (Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Prop-causal-2speciesStoch"
plural "false"
caps "false"
noprefix "false"

\end_inset

), with both methods able to select in most cases causality and non-causality.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="9">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Granger
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
causality
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CCM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
log>0.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rho>0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rho>0.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both0.2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
With
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 -> 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
98.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
94 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
94 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 -> 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100 %
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Without
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 -> 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 -> 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.2%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Proportion of simulations with Granger-causality or CCM between x and y
 over 500 simulations, for the stochastic 2-species competition model without
 environmental driver
\begin_inset Note Note
status open

\begin_layout Plain Layout
Let's try not to use the word significant when we're not absolutely constrained
 to do so.
\end_layout

\end_inset


\change_inserted -666822487 1555046963

\begin_inset CommandInset label
LatexCommand label
name "tab:Prop-causal-2speciesStoch"

\end_inset


\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/stochasticcompet_ccm.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergent-cross mapping on simulated stochastic data, with (red, blue)
 and without (orange, purple) competition between the two species, over
 500 simulations.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The MAR(p) model selected by BIC had a lag of 
\begin_inset Formula $p=3$
\end_inset

 timesteps, confirming that small lags should be used in such models.
\end_layout

\begin_layout Subsubsection*
With an environmental driver
\end_layout

\begin_layout Standard
\begin_inset Note Greyedout
status open

\begin_layout Plain Layout
This considerably more complex case where the two species are influenced
 by a shared environmental driver (e.g., temperature) yielded less clear cut
 results than stochastic 2-species competition.
 Overall, both methods recognize the effect of temperature on temperature
 on the two species growth, with and without interactions (slightly lower
 score for CCM for species 2, but overall good performance, Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:P-valuesStochCompetDriver"
plural "false"
caps "false"
noprefix "false"

\end_inset

) .
 CCM was better at uncovering interactions that were present in this case,
 GC had a good performance for the strong interaction 
\begin_inset Formula $2\rightarrow1$
\end_inset

 but not the reserve 
\begin_inset Formula $1\rightarrow2$
\end_inset

.
 Surprinsingly, this performance ranking is the reverse of that without
 the environmental driver.
 Both GC and CCM had difficulties indicating non-causality in this case
 (when there are no interactions), and indicated false positives, averaged
 over the two possible interactions, about 50% for both methods.
 It is therefore quite logical to say that both methods fail to detect an
 absence of interaction in this case.
 We also asked the 
\begin_inset Quotes eld
\end_inset

stupid
\begin_inset Quotes erd
\end_inset

 question of whether species 1 and 2 influenced temperature, assuming that
 both methods would fail.
 GC did surprisingly well in this context, showing only between 15 and 20%
 of false positives.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
CP: I greyed out the above because results are different now, from the ones
 that were commented, but it seems that they could be partly re-used.
 See Table 4.
 Do we want to talk about GC and CCM temp->sp1/2 (and maybe even the reverse
 ?), or do we keep temperature as a covariable on which we don't really
 want to focus?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Main points :
\end_layout

\begin_layout Itemize
Pairwise GC and conditional GC have really similar results, which could
 indicate that GC is not very sensitive to taking into account confounding
 factors (at least in our example).
\end_layout

\begin_layout Itemize
CCM with p-value based on seasonal surrogate (and, actually, also, simple
 permutation) performs better than 
\change_deleted -666822487 1555919239
CCM
\change_inserted -666822487 1555919239
GC
\change_unchanged
 to detect interactions but has a slightly higher false positive rates
\change_deleted -666822487 1555919247
 (
\change_inserted -666822487 1555919248
, which 
\change_unchanged
makes sense
\change_deleted -666822487 1555919249
)
\change_unchanged

\end_layout

\begin_layout Itemize
Even with seasonal surrogates, we still have spurious causalities in CCM
 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Comparison-dummy-CCM"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="10">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Granger
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
causality
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pairwise
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\change_inserted -666822487 1555919065
GC 
\change_deleted -666822487 1555919053
 
\change_unchanged
conditional
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CCM
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
seasonal surr
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
log-ratio>0.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
log
\change_inserted -666822487 1555921615
-ratio
\change_unchanged
>0.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pval<0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rho>0.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
With
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 -> 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
94.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
94.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
94.2%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 -> 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
92.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
88.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
88.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
87.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
84.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
83.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
97.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
96.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
96.6%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Without
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 -> 2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
27.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 -> 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
23.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.4%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
21.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.8%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.6%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.2%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Proportion of simulations with Granger-causality or CCM between x and y
 over 500 simulations for a model with 2 species and a driver (temperature)
 [Results for CCM with temperature are in the Appendices for now.
 ]
\begin_inset CommandInset label
LatexCommand label
name "tab:P-valuesStochCompetDriver"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../twoSpecies_andDriver/CCM_2species_and_envDriver_CP_centering_with_surrogates.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergent cross-mapping for the two species forced by an environmental
 driver (denoted as temp), when interactions are present (blue, red) and
 when interactions are absent (purple, orange), for 500 simulations.
 Dashed lines indicate the 10% interval for rho-values obtained from surrogate
 time series, i.e., time series that have the same seasonal forcing but whose
 cross-correlations are altered.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Larger interaction webs
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
[Includes both pairwise FDR-corrected GC inference (done) and LASSO-based
 MAR (done).
\end_layout

\begin_layout Plain Layout
Not clear that we can compare to CCM in this context, since I don't know
 how the FDR-correction they use, if any.
 ]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here we report the results of analyses for 10 and 20 species modular interaction
 webs.
 Lag order selection revealed that low-order MAR(p) models were selected
 (Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Lag-order-selection_large-models"
plural "false"
caps "false"
noprefix "false"

\end_inset

), with the BIC indicating 
\begin_inset Formula $p=1$
\end_inset

 as the most parcimonious choice.
 Hence we have focused on MAR(1) models.
 The high-dimensional 
\begin_inset Formula $S\times S$
\end_inset

 MAR(1) models include clustering (see Methods and Appendix SXX) because
 the basic LASSO-penalized VAR(1) models poorly identify modular interactions
 webs 
\begin_inset CommandInset citation
LatexCommand citep
key "charbonnier2010weighted"
literal "false"

\end_inset

.
 The recall, or true positive rate, that records how many true positives
 are identified as such, is almost always above 60% for the LASSO-based
 method (siMoNe, 
\begin_inset CommandInset citation
LatexCommand citealp
key "chiquet2008simone,charbonnier2010weighted"
literal "false"

\end_inset

) and up to 80%, which is a relatively good performance.
 Surprinsingly, we found that pairwise (direct) Granger causality testing
 was quite efficient, in this case more than the LASSO-based method.
 One issue though is that the level of significance has to be adjusted (we
 use a global 
\begin_inset Formula $\alpha$
\end_inset

= 20%), which is always somewhat subjective (but there are also always several
 tuning parameters in LASSO-based inferences, so some degree of subjectivity
 is everywhere).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../10species/ROC_Simone_BIC_ClusteringMixer_10_and_20_species.pdf
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
ROC plot for the 10 and 20 species webs, as analysed with a LASSO-based
 penalized MAR(1) model including clustering.
 In panel (a) and (b), each point represent multiple simulations of the
 same parameter set; in (c) and (d), we see multiple parameter sets.
 
\series bold
[Perhaps we can add a third column where we show CCM pairwise, if the results
 are not too ugly when we have the simplex].
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../10species/figures/ROC_pairwiseGC_large_p_pairwise_adj.pdf
	width 45text%
	special page=1

\end_inset


\begin_inset Graphics
	filename ../10species/figures/ROC_pairwiseGC_large_mat_simone.pdf
	width 45text%
	special page=1

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../10species/figures/ROC_pairwiseCCM_10species_pvalCobeyBaskerville_adj.pdf
	width 45text%
	special page=1

\end_inset


\begin_inset Graphics
	filename ../10species/figures/ROC_pairwiseCCM_10species_pvalCP_adj.pdf
	width 45text%
	special page=1

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
ROC curves for the 10 and 20-species model using the Granger Causality method
 (top) and the CCM method (bottom), with different ways of computing the
 causality.
 For GC, left is pairwise ; right is LASSO.
 For CCM, left is the Cobey-Baskerville method, right is the 
\begin_inset Quotes eld
\end_inset

shuffling
\begin_inset Quotes erd
\end_inset

-method (no 20-species model yet, still running)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../10species/figures/large_example_GC_p_pairwise_adj.pdf
	width 95text%
	special page=1

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../10species/figures/10species_example_CCM_pvalCP_adj.pdf
	width 95text%
	special page=1

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Interaction matrices obtained from pairwise GC (top) or 'shuffling' CCM
 (bottom).
 Blue circles are the true positives, red circles are false positives and
 black circles are false negatives.
 For the true and false positives, the size of the circles is proportional
 to the proportion of detection over 25 simulations.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section*
Discussion
\end_layout

\begin_layout Standard
We have shown above that MAR(p) modelling and Granger causality testing
 are fairly robust to nonlinearities in ecological dynamics, when applied
 on the appropriate logarithmic-abundance scale, and combined with model
 selection by information criteria.
 This is true for many nonlinear simulation models, including deterministic
 chaos.
 This confirms and extends findings from an investigation of the robustness
 to nonlinearities of log-linear MAR(1) models (with 
\begin_inset Formula $p$
\end_inset

 restricted to 1 lag, 
\begin_inset CommandInset citation
LatexCommand citealp
key "certain2018how"
literal "false"

\end_inset

).Comparison to the CCM framework by 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "false"

\end_inset

 further revealed that CCM and MAR(p)/Granger causal modelling can in fact
 - surprisingly - yield relatively similar results in nonlinear and stochastic
 dynamical systems of interacting species.
 Evidence for this comes 
\emph on
both
\emph default
 from highly nonlinear systems for which CCM and GC both infer interactions
 (stochastic competition) and from cases where both methods seem to fail
 to some degree (i.e., two competing species forced similarly by a shared
 environmental driver).
 Therefore, an important conclusion from our study is that both Granger
 causality and CCM are able to yield reasonable inferences on similar datasets,
 unless there is a very high degree of confounding 
\begin_inset CommandInset citation
LatexCommand citep
after "who showed similar results"
before "see also"
key "cobey2016limits"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Moreover, we use here false discovery rates and regularized models (i.e.,
 LASSO-penalized MAR(1) models developed for modular interaction networks,
 
\begin_inset CommandInset citation
LatexCommand citealp
key "charbonnier2010weighted"
literal "false"

\end_inset

) to tackle relatively-high dimensional models (10 and 20 species).
 This allows to better infer Granger causality in these contexts that, we
 surmise, will be most exciting to ecologists working on interacting species
 using community-level data.
 The results demonstrate that simple pairwise Granger causality (i.e., using
 
\begin_inset Formula $2\times2$
\end_inset

 MAR(p) models) are almost as good as the penalized MAR(1) models in finding
 the interaction network.
 We elaborate on these results and possible explanations below.
\end_layout

\begin_layout Subsection*
Is Granger causality a useful concept for highly nonlinear dynamical systems,
 and why?
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

 suggested that Granger causality would work well for simulated (log)-linear
 systems while CCM would work well for nonlinear dynamical systems.
 Reality, however, is less clear-cut.First, the analyses performed by 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

 et al.
 on the Veilleux and other datasets seem to rely on a slightly unorthodox
 model selection procedure.
 Reanalysing the data with a more classic, information-criteria motivated
 lag order selection, we show that in fact GC is perfectly able to find
 causality in the Veilleux predator-prey datasets.
\end_layout

\begin_layout Standard
We also reported above on results where even deterministic chaos can, surprising
ly, be wellidentified by MAR(p) models / GC inference (we expected CCM to
 completely dominate the scores and GC to fail entirely, but GC provided
 reasonable performances).
 Thus GC can be useful for highly nonlinear systems.
 Moreover, the converse is also true: some log-linear cases can also be
 well-identified by CCM, even though CCM relies upon the possibility to
 reconstruct an attractor in state space.
 Of course, as CCM has been developed specifically from nonlinear dynamical
 systems theory (and relies upon state-space reconstruction of chaotic models),
 it seems more appropriate for highly nonlinear and weakly stochastic cases,
 while MAR(p) models are best performers in weakly nonlinear and more stochastic
 situations.
 Nonetheless, it was very surprising to see how well MAR(p) models can perform
 in deterministic chaos in a number of cases, unlike what could have been
 expected from the previous study of 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

.
 Though we clearly acknowledge that some chaotic scenarios may inevitably
 lead to a difficulty in GC inference.
\end_layout

\begin_layout Standard
Several recents attempts to perform nonlinear inference of interactions
 support our findings.
 
\begin_inset CommandInset citation
LatexCommand citet
key "suzuki2017equationfree"
literal "true"

\end_inset

 use stochastic GLV models and a model selection algorithm derived from
 
\begin_inset CommandInset citation
LatexCommand citet
key "fisher2014identifying"
literal "true"

\end_inset

, and even though they use the S-map, because their evaluation is based
 on prediction, they actually perform a nonlinear Granger inference.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
[Suzuki et al.
 actually do nonlinear GC without knowing it!!]
\end_layout

\end_inset

.
 The neuroscience, gene regulation networks and related dynamical systmems
 literature is awash with nonlinear GC inferences, often confirmed by simulation
s of nonlinear stochastic systems 
\begin_inset CommandInset citation
LatexCommand citep
key "Marinazzo2008,yang2017reconstruction"
literal "true"

\end_inset

 [some more examples here].
 Hence there is fairly good evidence that either log-linear (power-law)
 or nonlinear GC inference is possible for nonlinear stochastic systems
 of interacting species.
\end_layout

\begin_layout Standard
As shown by our analyses for large interaction webs, GC can be extended
 to quite large webs, both in a pairwise GC context and in a conditional
 GC (full model fitting) context.
 
\series bold
[More discussion of these results here and more on CCM results when we have
 those]
\end_layout

\begin_layout Subsection*
How can Granger causality and convergent cross-mapping yield similar inferences?
\end_layout

\begin_layout Standard
Here, we would like to go back to the heart of the issue that 
\begin_inset CommandInset citation
LatexCommand citet
key "sugihara2012detecting"
literal "true"

\end_inset

 highlighted, causality reversion in nonlinear dynamical systems.
 The standard Granger causality holds that whenever a model 
\begin_inset Formula $Y_{t+h}|({Y_{t},X_{t}}_{t\in A_{t}})$
\end_inset

 better predicts the observed time series 
\begin_inset Formula $(y_{t})$
\end_inset

 than a model 
\begin_inset Formula $Y_{t+h}|({Y_{t}}_{t\in A_{t}})$
\end_inset

, then 
\begin_inset Formula $x$
\end_inset

 is causal for 
\begin_inset Formula $y$
\end_inset

.
 CCM instead holds that whenever 
\begin_inset Formula $\rho(x,\hat{x}|M_{Y})$
\end_inset

 increases strongly with the library size 
\begin_inset Formula $L$
\end_inset

 use to reconstruct 
\begin_inset Formula $x$
\end_inset

 from the shadow manifold 
\begin_inset Formula $M_{Y}$
\end_inset

.
 It seems that in the latter method, 
\begin_inset Formula $x$
\end_inset

 causes 
\begin_inset Formula $y$
\end_inset

 whenever knowledge about 
\begin_inset Formula $y$
\end_inset

 can be used to recontruct 
\begin_inset Formula $x$
\end_inset

.
 However, verbal reasoning is treacherous there.
 To determine whether 
\begin_inset Formula $x$
\end_inset

 causes 
\begin_inset Formula $y$
\end_inset

:
\end_layout

\begin_layout Itemize
GC compares knowledge about 
\begin_inset Formula $Y_{t}$
\end_inset

 vs.
 knowledge about 
\begin_inset Formula $X_{t},Y_{t}$
\end_inset

 in prediction of 
\begin_inset Formula $Y_{t+h}$
\end_inset


\end_layout

\begin_layout Itemize
CCM compares knowledge about 
\begin_inset Formula $Y_{t}$
\end_inset

 vs.
 no knowledge about 
\begin_inset Formula $Y_{t}$
\end_inset

 in prediction of 
\begin_inset Formula $X_{t}$
\end_inset

.
\end_layout

\begin_layout Standard
Using a standard autogressive model, the equivalent of a CCM test 
\begin_inset Formula $x\rightarrow y$
\end_inset

 would be predicting 
\begin_inset Formula $X_{t}$
\end_inset

 by a model 
\begin_inset Formula $X_{t}|{Y_{t}}$
\end_inset

 vs 
\begin_inset Formula $X_{t}$
\end_inset

.
 There is no conditionality upon past 
\begin_inset Formula $X_{t}$
\end_inset

 values in the prediction step of the algorithm.
 Thus there is no causality reversion that is intrinsic to nonlinear dynamic
 testing: GC and CCM are simply two different types of causality testing
 that are based upon 
\emph on
different assumptions on the conditioning set
\emph default
 and 
\emph on
ways to select models
\emph default
.
 We therefore conclude for these methods and concepts to work relatively
 similarly, they must share some underlying similarities that not yet evident
 to theoretical and statistical ecologists.
 More mathematical research on the possible connections and differences
 between these methods is obviously needed to better see in which scenarios
 each should be favored.
\end_layout

\begin_layout Subsection*
Going further
\begin_inset Note Note
status open

\begin_layout Plain Layout
[this section will be expanded]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Based on our simulations, complemented with those of the neuroscience literature
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ding2006,Chen2006,barnett_mvgc_2014,Marinazzo2008"
literal "true"

\end_inset

, we suggest that Granger causality, in its log-linear (this paper) or nonlinear
 varieties 
\begin_inset CommandInset citation
LatexCommand citep
key "Marinazzo2008,suzuki2017equationfree"
literal "true"

\end_inset

, is appropriate to infer ecological interactions.
 CCM is another interesting method to infer interactions.
 Although it has been shown that some scenarios like seasonal forcing might
 render interaction inference difficult 
\begin_inset CommandInset citation
LatexCommand citep
key "cobey2016limits"
literal "true"

\end_inset

, we think that as always details of implementation are important, thus
 it is important not to disqualify a method in the early stages of its developme
nt.
\end_layout

\begin_layout Standard
From an almost sociological viewpoint, we conclude that recommending to
 abandon established statistical methods like GC, or linear modelling after
 transformation more generally, in favor of promising yet not fully tested
 statistical methods may not always help ecological science.
 More fruitful methodological development might highlight the pros and cons
 of new developments in statistical inference under a broad range of simulated
 scenarios.
\end_layout

\begin_layout Standard
From a statistical perspective, looking at the various implementations of
 GC and CCM, it seems that the hardest methodological choice to make is
 almost invariably not the type of functional form or embedding (linear,
 nonlinear, etc.) but the conditioning set, i.e.
 the information that is considered to be known for the prediction 
\begin_inset CommandInset citation
LatexCommand citep
key "eichler2013causal"
literal "true"

\end_inset

.
 Strategies to better understand how to choose the conditioning set when
 doing causal inference will be, we believe, a very important feature of
 ecological interaction inference for the years to come.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Discuss also strategies to avoid talking about causality altogether, e.g.,
 dimension reduction methods based on PCA, Ovaskainen et al.
 loading factors etc.
 Causality -> implies a dichotomization.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "GC_bib"
options "ecol_let"

\end_inset


\end_layout

\begin_layout Part*
Appendices and Supplements
\end_layout

\begin_layout Section*
Nonlinear Granger causality
\begin_inset CommandInset label
LatexCommand label
name "sec:Nonlinear-Granger-causality"

\end_inset


\end_layout

\begin_layout Subsection*
Transfer entropy and nonlinear Granger causality
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
[FB: this section may go]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Transfer entropy can be defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
{\mathcal{T}}_{x\rightarrow y|z}=H(\boldsymbol{y}^{t_{m}+1}|\boldsymbol{y}^{t_{m}},\boldsymbol{z}^{t_{m}})-H(\boldsymbol{y}^{t_{m}+1}|\boldsymbol{y}^{t_{m}},\boldsymbol{x}^{t_{m}},\boldsymbol{z}^{t_{m}})
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $y^{t_{m}+1}=(y_{2},...,y_{t_{m}+1})$
\end_inset

 and 
\begin_inset Formula $y^{t_{m}}=(y_{1},...,y_{t_{m}})$
\end_inset

.
 The quantity 
\begin_inset Formula $H(x|y)=H(x,y)-H(y)$
\end_inset

 is a conditional entropy, defined with 
\begin_inset Formula $H(x)$
\end_inset

 the Shannon entropy.
 It has then been shown that the Granger causal measure 
\begin_inset Formula $\mathcal{G}_{x\rightarrow y|z}=\ln(\frac{\sigma_{\eta}^{2}}{\sigma_{\epsilon}^{2}})$
\end_inset

 where the residuals errors are take from eqs.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:directGC"

\end_inset

 can be generalized to 
\begin_inset Formula ${\mathcal{T}}_{x\rightarrow y|z}$
\end_inset

.
 In the linear case, 
\begin_inset CommandInset citation
LatexCommand citet
key "barnett2009granger"
literal "true"

\end_inset

 proved that 
\begin_inset Formula ${\mathcal{G}}_{x\rightarrow y|z}=2{\mathcal{T}}_{x\rightarrow y|z}$
\end_inset

, so that Granger causality through MAR(1) modelling is a special case of
 causality defined through transfer entropy.
\end_layout

\begin_layout Standard
In general, any method which evaluates whether adding a new time series
 
\begin_inset Formula $\mathbf{x}$
\end_inset

 to a dynamical system for variables 
\begin_inset Formula $y_{1},...,y_{n}$
\end_inset

 improves prediction of 
\begin_inset Formula $y_{i}$
\end_inset

 can be defined as a generalised GC method 
\begin_inset Formula $x\rightarrow y_{i}|(y_{1},y_{2},...,y_{i-1},y_{i+1},...,y_{n}).$
\end_inset

 Quite a number of nonlinear Granger causality inference techniques then
 fall within this category 
\begin_inset CommandInset citation
LatexCommand citep
before "e.g.,"
key "Marinazzo2008,Palus2008"
literal "true"

\end_inset

.
\end_layout

\begin_layout Section*
Additional results
\end_layout

\begin_layout Subsubsection*
Example simulation of 2-species stochastic Ricker model
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/stochastic_competition_model.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
2-species Ricker model [ref to eqs.
 of main text] with (blue = species 1, red = species 2) and without (purple
 = species 1, orange = species 2) competition.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Choice of p-values and additional thresholds
\end_layout

\begin_layout Standard
During 
\change_deleted -666822487 1555919345
the first
\change_inserted -666822487 1555919347
preliminary
\change_unchanged
 simulations, we discovered
\change_inserted -666822487 1555919373
 
\change_deleted -666822487 1555919368
 
\change_unchanged
that false causalities
\change_inserted -666822487 1555919395
 in absence of interactions
\change_deleted -666822487 1555919431
, or absence thereof,
\change_unchanged
 could 
\change_deleted -666822487 1555919442
be prominent in our simulations
\change_inserted -666822487 1555919450
arise in a number of cases
\change_unchanged
, which could indicate that the usual p-values and associated thresholds
 (
\change_inserted -666822487 1555919476

\begin_inset Formula $\alpha=$
\end_inset

 
\change_unchanged
10% for 2-species simulations, 20% for 10- and 20-species simulations) were
 not sufficient to deduce interactions.
 We thus searched for additional conditions on the estimates
\change_inserted -666822487 1555919502
, such as effect sizes, 
\change_deleted -666822487 1555919495
 
\change_unchanged
to conclude to causality.
 We based our analyses on the stochastic model described in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:twoSpeRickerStoch_compet"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\change_inserted -2100369821 1555681976

\end_layout

\begin_layout Standard
For Granger-causality, we computed the log-ratio of the residuals sum of
 squares (using notations from eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:directGC"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GC_bis"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\log\left(\frac{\sum\eta_{i}Â²}{\sum\epsilon_{i}Â²}\right)$
\end_inset

 ) and the average effect of the causal species (
\begin_inset Formula $\frac{\sum_{i}|a_{1i}|}{L}$
\end_inset

).
 We see on Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Comparison-of-methods_GC"
plural "false"
caps "false"
noprefix "false"

\end_inset

) that the log
\change_inserted -666822487 1555919539
-
\change_deleted -666822487 1555919538
 
\change_unchanged
ratio tends to be a more efficient indicator of causality and that fixing
 a threshold of 0.04 on this ratio seems to achieve a good balance between
 false negatives and positives.
\change_inserted -2100369821 1555682710

\end_layout

\begin_layout Standard

\change_inserted -2100369821 1555681465
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center

\change_inserted -2100369821 1555681518
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/explo_Stochastic_GC.pdf
	width 85text%

\end_inset


\change_unchanged

\end_layout

\begin_layout Plain Layout

\change_inserted -2100369821 1555681465
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of methods to determine Granger-causality between two variables
 in a stochastic model.
 Log ratio of residuals sum of squares (a) and average effect of the causal
 species (b) are compared, and the proportions of false negatives (red and
 orange) and false positives (blue and cyan), depending on the p-value and
 threshold imposed on these effects, are shown in d) 
\begin_inset CommandInset label
LatexCommand label
name "fig:Comparison-of-methods_GC"

\end_inset


\end_layout

\end_inset


\change_unchanged

\end_layout

\end_inset


\end_layout

\begin_layout Standard
For the Convergent Cross-Mapping, the computation of the p-value itself
 was an issue (as discussed above).
 We compared the p-value described by 
\begin_inset CommandInset citation
LatexCommand citet
key "cobey2016limits"
literal "false"

\end_inset

, and three different types of surrogates: permutation, distance-based ('twin',
 the sampling replaces one point by another which remains close in value)
 or frequency-based ('Ebisuzaki', the time series spectrum is kept during
\change_deleted -666822487 1555919631
 the
\change_unchanged
 resampling).
 We also examined the effect of putting a threshold on the value of 
\begin_inset Formula $\rho$
\end_inset

.
 We see on Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Comparison-pval-CCM"
plural "false"
caps "false"
noprefix "false"

\end_inset

 that surrogate-based p-values are more efficient to detect causalities.
 As they have very similar behaviors, we chose to keep the simplest (and
 least computatio
\change_deleted -666822487 1555919653
n
\change_unchanged
nally intensive) method, based on 
\change_deleted -666822487 1555919661
random threshold
\change_inserted -666822487 1555919667
permutation
\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -666822487 1555919674
check, Coralie?
\change_unchanged

\end_layout

\end_inset


\change_unchanged
.
 We 
\change_deleted -666822487 1555919683
can also put
\change_inserted -666822487 1555919686
also considered 
\change_deleted -666822487 1555919683
 
\change_unchanged
a threshold at 0.1
\change_inserted -666822487 1555919730
 or 0.2 
\change_deleted -666822487 1555919700

\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
OR 0.2 ?
\end_layout

\end_inset


\change_unchanged
 on 
\begin_inset Formula $\rho$
\end_inset

 values to avoid the majority of false positives and false negatives.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/explo_Stochastic_CCM_pval_tmp.pdf
	width 85text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/threshold_according_to_pval_and_rho_CCM_Stochastic.pdf
	width 85text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of different ways of computing p-values for the stochastic 2-species
 model (top), and their effect on the inference of causality (bottom).
 The number of p-values which are found to be 0, among the 500 simulations
 estimated, is written at the bottom of the p-value boxplot.
 The number 
\begin_inset CommandInset label
LatexCommand label
name "fig:Comparison-pval-CCM"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Did the same thing on the chaotic simulations and found qualitatively similar
 results (can be found in the folder comparison...2species).
 The only thing that's troublesome is the very high ratio for 1->2 no inter
 ; this is actually due to a problem in the ar-estimation process.
 It would work better with the Yule-Walker method, but then we could not
 compare results with VAR, wich uses OLS.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Seeing this, I propose to redo the other analyses (10/20 species with these
 thresholds and a surrogate-based p-value)
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Effect of log-transformation on CCM
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/CCM_Veilleux2DataSets_noreplace.pdf
	width 95text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convergent Cross-Mapping with (left) and without (right) ln-transform of
 the data for the Veilleux dataset
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Lag order p selection in the MAR(p) framework, for the deterministic competition
 model
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../comparisonGranger_vs_CCM_2species/LagOrderSelection2Species_chaos_interaction.pdf
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Results of model information criteria vs.
 lag order for the simulated deterministic competition model of eqs.
 XX
\begin_inset CommandInset label
LatexCommand label
name "fig:ResultsDeterCompet_lagOrder"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Spurious causality when including a confounding factor
\end_layout

\begin_layout Subsubsection*
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../twoSpecies_andDriver/explo_with_driver_CCM_sp1sp2temp_dummy.pdf
	width 95text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Comparison of log10(p-values) and CCM skill (rho) values to examine effects
 of temperature (T) on species 1 and 2 (s1 and s2), and the spurious reverse
 causality (species 1 or 2 causing temperature).
 Simulations were ran with (+I) and without (-I) interactions between species
 1 and 2.
 Numbers below the boxplots indicate the number of times the p-value was
 0, over 500 simulations.
 The 10% false positive threshold is indicated by a line on the pval plots
 (p-value must be below this line for the causality to be inferred) while
 the 0.1 and 0.2 thresholds that could be imposed on rho values are dotted
 lines in the right panel (rho must be above the line for the causalityto
 be inferred)
\begin_inset CommandInset label
LatexCommand label
name "fig:Comparison-dummy-CCM"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Lag order selection for the 10- and 20-species model
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../10species/figures/lag_order_large_communities.pdf
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Lag order selection for the 10-species (a)and one of the 20-species stochastic
 community model (b).
\series bold

\begin_inset CommandInset label
LatexCommand label
name "fig:Lag-order-selection_large-models-2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_body
\end_document
